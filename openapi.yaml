openapi: 3.1.0
info:
  title: Real Estate Post Generator API
  description: |
    Generate professional real estate social media post images.
    Supports multiple layouts, post types, color themes, and sizes.
    Returns PNG image URLs ready for download and sharing.
  version: 1.0.0
servers:
  - url: https://your-app-name.onrender.com
    description: Production server (update with your actual deployment URL)
  - url: http://localhost:3000
    description: Local development server

paths:
  /generate:
    post:
      operationId: generatePost
      summary: Generate a real estate social media post image
      description: |
        Takes property data and template configuration, renders a professional
        social media post image, and returns the image URL(s).
        For carousel layouts, returns multiple slide URLs.
      requestBody:
        required: true
        content:
          application/json:
            schema:
              $ref: '#/components/schemas/GenerateRequest'
      responses:
        '200':
          description: Image generated successfully
          content:
            application/json:
              schema:
                oneOf:
                  - $ref: '#/components/schemas/SingleImageResponse'
                  - $ref: '#/components/schemas/CarouselImageResponse'
        '400':
          description: Invalid request parameters
          content:
            application/json:
              schema:
                $ref: '#/components/schemas/ErrorResponse'
        '500':
          description: Image generation failed
          content:
            application/json:
              schema:
                $ref: '#/components/schemas/ErrorResponse'

  /templates:
    get:
      operationId: listTemplates
      summary: List all available template options
      description: |
        Returns all available layouts, post types, color themes, and sizes
        that can be combined to generate posts.
      responses:
        '200':
          description: Template options listed successfully
          content:
            application/json:
              schema:
                $ref: '#/components/schemas/TemplateListResponse'

  /templates/preview/{combo}:
    get:
      operationId: previewTemplate
      summary: Generate a preview of a template combination with sample data
      description: |
        Generates a preview image using sample property data.
        The combo parameter format is: layout_postType_colorTheme_size
        Example: hero-single_new-listing_dark_instagram-post
      parameters:
        - name: combo
          in: path
          required: true
          description: |
            Template combination in format: layout_postType_colorTheme_size
            Example: hero-single_new-listing_dark_instagram-post
          schema:
            type: string
            example: hero-single_new-listing_dark_instagram-post
      responses:
        '200':
          description: Preview generated successfully
          content:
            application/json:
              schema:
                type: object
                properties:
                  success:
                    type: boolean
                  preview:
                    oneOf:
                      - $ref: '#/components/schemas/SingleImageResult'
                      - $ref: '#/components/schemas/CarouselImageResult'
        '400':
          description: Invalid combo format
          content:
            application/json:
              schema:
                $ref: '#/components/schemas/ErrorResponse'

  /image/{filename}:
    get:
      operationId: getImage
      summary: Serve a generated image file
      description: Returns the PNG image file. Images are available for 24 hours after generation.
      parameters:
        - name: filename
          in: path
          required: true
          description: The image filename (UUID format with .png extension)
          schema:
            type: string
            example: 550e8400-e29b-41d4-a716-446655440000.png
      responses:
        '200':
          description: Image file
          content:
            image/png:
              schema:
                type: string
                format: binary
        '404':
          description: Image not found
          content:
            application/json:
              schema:
                $ref: '#/components/schemas/ErrorResponse'

components:
  schemas:
    GenerateRequest:
      type: object
      required:
        - template
        - property
      properties:
        template:
          type: object
          required:
            - layout
            - postType
            - colorTheme
            - size
          properties:
            layout:
              type: string
              enum:
                - hero-single
                - split-duo
                - feature-trio
                - grid-quad
                - grid-six
                - carousel-slides
              description: |
                The photo layout style.
                hero-single: 1 large hero image with text overlay.
                split-duo: 2 photos side by side with info bar.
                feature-trio: 1 large + 2 stacked photos.
                grid-quad: 4 photos in a grid.
                grid-six: 6 photos in a 3x2 grid.
                carousel-slides: Multiple slides for Instagram carousel.
            postType:
              type: string
              enum:
                - new-listing
                - open-house
                - just-sold
                - price-drop
                - coming-soon
              description: |
                The type of real estate post.
                new-listing: "NEW LISTING" badge.
                open-house: "OPEN HOUSE" with date/time.
                just-sold: "SOLD" stamp.
                price-drop: "PRICE REDUCED" with old/new price.
                coming-soon: "COMING SOON" teaser.
            colorTheme:
              type: string
              enum:
                - dark
                - light
                - blue
                - gold
                - minimal
                - custom
              description: |
                Color theme for the post.
                dark: Dark bg, white/gold text.
                light: White/cream bg, dark text.
                blue: Navy/blue tones.
                gold: Black and gold luxury.
                minimal: White, thin fonts.
                custom: Use customColors field.
            size:
              type: string
              enum:
                - instagram-post
                - instagram-story
                - facebook-post
              description: |
                Target image size.
                instagram-post: 1080x1080.
                instagram-story: 1080x1920.
                facebook-post: 1200x630.
            customColors:
              type: object
              description: Required when colorTheme is "custom"
              properties:
                primary:
                  type: string
                  description: Primary/background hex color
                  example: "#1a1a2e"
                accent:
                  type: string
                  description: Accent hex color
                  example: "#e2b659"
        property:
          type: object
          required:
            - title
          properties:
            title:
              type: string
              description: Property title/name
              example: Luxury Ocean View Apartment
            price:
              type: string
              description: Current asking price (formatted with currency symbol)
              example: "$350,000"
            oldPrice:
              type: string
              description: Previous price (used with price-drop post type)
              example: "$395,000"
            location:
              type: string
              description: Property location
              example: Punta Pacifica, Panama City
            bedrooms:
              type: integer
              description: Number of bedrooms
              example: 3
            bathrooms:
              type: integer
              description: Number of bathrooms
              example: 2
            area:
              type: string
              description: Property area/size with unit
              example: "185 mÂ²"
            features:
              type: array
              items:
                type: string
              description: List of property features/amenities
              example: ["Ocean View", "Pool", "Gym", "24hr Security"]
            description:
              type: string
              description: Property description text
              example: "Stunning 3-bedroom apartment with panoramic ocean views..."
            photos:
              type: array
              items:
                type: string
                format: uri
              description: |
                Array of photo URLs. Provide as many as the layout needs:
                hero-single: 1, split-duo: 2, feature-trio: 3,
                grid-quad: 4, grid-six: 6, carousel-slides: any number.
                Missing photos will show a placeholder.
              example:
                - "https://example.com/photo1.jpg"
                - "https://example.com/photo2.jpg"
        openHouse:
          type: object
          description: Open house details (used with open-house post type)
          properties:
            date:
              type: string
              description: Open house date
              example: "Saturday, March 15"
            time:
              type: string
              description: Open house time range
              example: "10:00 AM - 2:00 PM"

    SingleImageResponse:
      type: object
      properties:
        success:
          type: boolean
          example: true
        type:
          type: string
          enum: [single]
        url:
          type: string
          format: uri
          description: URL to download the generated image
          example: "https://your-app.onrender.com/image/550e8400-e29b-41d4-a716-446655440000.png"

    CarouselImageResponse:
      type: object
      properties:
        success:
          type: boolean
          example: true
        type:
          type: string
          enum: [carousel]
        slideCount:
          type: integer
          description: Number of carousel slides generated
          example: 7
        urls:
          type: array
          items:
            type: string
            format: uri
          description: URLs for each carousel slide image
          example:
            - "https://your-app.onrender.com/image/abc123-slide-1.png"
            - "https://your-app.onrender.com/image/abc123-slide-2.png"

    SingleImageResult:
      type: object
      properties:
        type:
          type: string
          enum: [single]
        url:
          type: string
          format: uri

    CarouselImageResult:
      type: object
      properties:
        type:
          type: string
          enum: [carousel]
        urls:
          type: array
          items:
            type: string
            format: uri

    TemplateListResponse:
      type: object
      properties:
        layouts:
          type: array
          items:
            type: object
            properties:
              id:
                type: string
              name:
                type: string
              description:
                type: string
              photoCount:
                oneOf:
                  - type: integer
                  - type: string
        postTypes:
          type: array
          items:
            type: object
            properties:
              id:
                type: string
              name:
                type: string
              description:
                type: string
        colorThemes:
          type: array
          items:
            type: object
            properties:
              id:
                type: string
              name:
                type: string
              description:
                type: string
        sizes:
          type: array
          items:
            type: object
            properties:
              id:
                type: string
              name:
                type: string
              dimensions:
                type: object
                properties:
                  width:
                    type: integer
                  height:
                    type: integer

    ErrorResponse:
      type: object
      properties:
        error:
          type: string
          description: Error message
        details:
          type: string
          description: Additional error details
